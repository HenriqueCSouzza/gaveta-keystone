(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{1086:function(e,t,i){"use strict";i.d(t,{p:function(){return M}});var n=i(7896),l=i(4273),a=i.n(l),o=i(5632),r=i(2784),s=i(5631),d=i(5445),c=i(6759),u=i(3123),g=i(8999),m=i(3900),p=i(5364),h=i(8626),v=i(2445),f=i(1720),Z=i(5118),y=(i(7268),i(1160)),x=i(3379),b=i(81),w=i(794),k=i(9575),C=i(8799),F=i(5852),$=i(839),S=i(7162);i(9378),i(6765),i(4002),i(7132),i(7668),i(1168),i(5976),i(581),i(9403),i(487),i(891),i(5273),i(1511),i(9097),i(444);function R(e){const t=(0,r.useRef)(e),i=(0,r.useCallback)((function(){return t.current(...arguments)}),[]);return(0,r.useEffect)((()=>{t.current=e})),i}function I(e){var t,i,n;let{listKey:l,itemGetter:a,selectedFields:o,fieldModes:s,showDelete:c}=e;const u=(0,k.sm)(l),[g,{loading:m,error:h,data:v}]=(0,x.D)(b.Ps`mutation ($data: ${u.gqlNames.updateInputName}!, $id: ID!) {
      item: ${u.gqlNames.updateMutationName}(where: { id: $id }, data: $data) {
        ${o}
      }
    }`,{errorPolicy:"all"});a=null!==(t=(0,r.useMemo)((()=>{if(v)return(0,f.m)(v,null===h||void 0===h?void 0:h.graphQLErrors).get("item")}),[v,h]))&&void 0!==t?t:a;const[w,C]=(0,r.useState)((()=>({value:(0,y.d)(u.fields,a),item:a})));if(!m&&w.item.data!==a.data&&(a.errors||[]).every((e=>{var t;return 1!==(null===(t=e.path)||void 0===t?void 0:t.length)}))){const e=(0,y.d)(u.fields,a);C({value:e,item:a})}const{changedFields:$,dataForUpdate:S}=(0,y.u)(u.fields,w.item,w.value),I=(0,y.a)(u.fields,w.value),[M,E]=(0,r.useState)(!1),L=(0,p.e)(),T=R((()=>{const e=0!==I.size;E(e),e||g({variables:{data:S,id:w.item.get("id").data}}).then((e=>{let{errors:t}=e;const i=null===t||void 0===t?void 0:t.find((e=>{var t;return 1===(null===(t=e.path)||void 0===t?void 0:t.length)}));i?L.addToast({title:"Failed to update item",tone:"negative",message:i.message}):L.addToast({tone:"positive",title:"Saved successfully"})})).catch((e=>{L.addToast({title:"Failed to update item",tone:"negative",message:e.message})}))})),q=u.isSingleton?u.label:null===(i=w.item.data)||void 0===i?void 0:i[u.labelField],N=null===(n=w.item.data)||void 0===n?void 0:n.id,B=!!$.size;return(0,F.u)((0,r.useMemo)((()=>({current:B})),[B])),(0,d.tZ)(d.xu,{marginTop:"xlarge"},(0,d.tZ)(F.G,{networkError:null===h||void 0===h?void 0:h.networkError,errors:null===h||void 0===h?void 0:h.graphQLErrors.filter((e=>{var t;return 1===(null===(t=e.path)||void 0===t?void 0:t.length)}))}),(0,d.tZ)(Z.F,{fieldModes:s,fields:u.fields,forceValidation:M,invalidFields:I,onChange:(0,r.useCallback)((e=>{C((t=>({item:t.item,value:e(t.value)})))}),[C]),value:w.value}),(0,d.tZ)(z,{onSave:T,hasChangedFields:!!$.size,onReset:R((()=>{C((e=>({item:e.item,value:(0,y.d)(u.fields,e.item)})))})),loading:m,deleteButton:(0,r.useMemo)((()=>c?(0,d.tZ)(D,{list:u,itemLabel:null!==q&&void 0!==q?q:N,itemId:N}):void 0),[c,u,q,N])}))}function D(e){let{itemLabel:t,itemId:i,list:n}=e;const l=(0,p.e)(),[a,{loading:c}]=(0,x.D)(b.Ps`mutation ($id: ID!) {
      ${n.gqlNames.deleteMutationName}(where: { id: $id }) {
        id
      }
    }`,{variables:{id:i}}),[u,m]=(0,r.useState)(!1),h=(0,o.useRouter)();return(0,d.tZ)(r.Fragment,null,(0,d.tZ)(s.zx,{tone:"negative",onClick:()=>{m(!0)}},"Delete"),(0,d.tZ)(g.aR,{title:"Delete Confirmation",isOpen:u,tone:"negative",actions:{confirm:{label:"Delete",action:async()=>{try{await a()}catch(e){return l.addToast({title:`Failed to delete ${n.singular} item: ${t}`,message:e.message,tone:"negative"})}return h.push(n.isSingleton?"/":`/${n.path}`),l.addToast({title:t,message:`Deleted ${n.singular} item successfully`,tone:"positive"})},loading:c},cancel:{label:"Cancel",action:()=>{m(!1)}}}},"Are you sure you want to delete ",(0,d.tZ)("strong",null,t),"?"))}const M=e=>()=>(0,d.tZ)(E,e),E=e=>{var t,i,l,g;let{listKey:p}=e;const Z=(0,k.sm)(p),y=(0,o.useRouter)().query.id,{spacing:x,typography:R}=(0,d.Fg)(),{query:D,selectedFields:M}=(0,r.useMemo)((()=>{let e=Object.entries(Z.fields).filter((e=>{let[t,i]=e;return"hidden"!==i.itemView.fieldMode||"id"===t})).map((e=>{let[t]=e;return Z.fields[t].controller.graphqlSelection})).join("\n");return{selectedFields:e,query:b.Ps`
        query ItemPage($id: ID!, $listKey: String!) {
          item: ${Z.gqlNames.itemQueryName}(where: {id: $id}) {
            ${e}
          }
          keystone {
            adminMeta {
              list(key: $listKey) {
                hideCreate
                hideDelete
                fields {
                  path
                  itemView(id: $id) {
                    fieldMode
                  }
                }
              }
            }
          }
        }
      `}}),[Z]);let{data:E,error:z,loading:L}=(0,w.a)(D,{variables:{id:y,listKey:p},errorPolicy:"all",skip:void 0===y});L||(L=void 0===y);const q=(0,f.m)(E,null===z||void 0===z?void 0:z.graphQLErrors);let N=(0,r.useMemo)((()=>{var e,t,i,n,l;let a={};return null===(e=q.data)||void 0===e||null===(t=e.keystone)||void 0===t||null===(i=t.adminMeta)||void 0===i||null===(n=i.list)||void 0===n||null===(l=n.fields)||void 0===l||l.forEach((e=>{var t;null!==e&&null!==e.path&&null!=(null===e||void 0===e||null===(t=e.itemView)||void 0===t?void 0:t.fieldMode)&&(a[e.path]=e.itemView.fieldMode)})),a}),[null===(t=q.data)||void 0===t||null===(i=t.keystone)||void 0===i||null===(l=i.adminMeta)||void 0===l||null===(g=l.list)||void 0===g?void 0:g.fields]);const B=q.get("keystone").errors,K=Z.isSingleton?Z.label:L?void 0:E&&E.item&&(E.item[Z.labelField]||E.item.id)||y;return(0,d.tZ)(C.P,{title:K,header:(0,d.tZ)(S.I,{list:Z,label:L?"Loading...":E&&E.item&&(E.item[Z.labelField]||E.item.id)||y})},L?(0,d.tZ)(d.M5,{css:{height:`calc(100vh - ${C.H}px)`}},(0,d.tZ)(c.xg,{label:"Loading item data",size:"large",tone:"passive"})):B?(0,d.tZ)(d.xu,{marginY:"xlarge"},(0,d.tZ)(m.qX,{tone:"negative"},B[0].message)):(0,d.tZ)(S.C,null,null==(null===E||void 0===E?void 0:E.item)?(0,d.tZ)(d.xu,{marginY:"xlarge"},null!==z&&void 0!==z&&z.graphQLErrors.length||null!==z&&void 0!==z&&z.networkError?(0,d.tZ)(F.G,{errors:null===z||void 0===z?void 0:z.graphQLErrors,networkError:null===z||void 0===z?void 0:z.networkError}):Z.isSingleton?"1"===y?(0,d.tZ)(d.Kq,{gap:"medium"},(0,d.tZ)(m.qX,{tone:"negative"},Z.label," doesn't exist or you don't have access to it."),!E.keystone.adminMeta.list.hideCreate&&(0,d.tZ)($.C,{list:Z})):(0,d.tZ)(m.qX,{tone:"negative"},'The item with id "',y,'" does not exist'):(0,d.tZ)(m.qX,{tone:"negative"},'The item with id "',y,"\" could not be found or you don't have access to it.")):(0,d.tZ)(r.Fragment,null,(0,d.tZ)(I,{fieldModes:N,selectedFields:M,showDelete:!E.keystone.adminMeta.list.hideDelete,listKey:p,itemGetter:q.get("item")}),(0,d.tZ)(T,null,(0,d.tZ)(v.Qy,null,"Item ID"),(0,d.tZ)("div",{css:{display:"flex",alignItems:"center"}},(0,d.tZ)(v.oi,{css:{marginRight:x.medium,fontFamily:R.fontFamily.monospace,fontSize:R.fontSize.small},readOnly:!0,value:E.item.id}),(0,d.tZ)(h.u,{content:"Copy ID"},(e=>(0,d.tZ)(s.zx,(0,n.Z)({},e,{"aria-label":"Copy ID",onClick:()=>{a()(E.item.id)}}),(0,d.tZ)(u.K,{size:"small"})))))))))},z=(0,r.memo)((function(e){let{hasChangedFields:t,loading:i,onSave:n,onReset:l,deleteButton:a}=e;return(0,d.tZ)(S.B,null,(0,d.tZ)(s.zx,{isDisabled:!t,isLoading:i,weight:"bold",tone:"active",onClick:n},"Save changes"),(0,d.tZ)(d.Kq,{align:"center",across:!0,gap:"small"},t?(0,d.tZ)(L,{onReset:l}):(0,d.tZ)(d.xv,{weight:"medium",paddingX:"large",color:"neutral600"},"No changes"),a))}));function L(e){const[t,i]=(0,r.useState)(!1);return(0,d.tZ)(r.Fragment,null,(0,d.tZ)(s.zx,{weight:"none",onClick:()=>{i(!0)}},"Reset changes"),(0,d.tZ)(g.aR,{actions:{confirm:{action:()=>e.onReset(),label:"Reset changes"},cancel:{action:()=>i(!1),label:"Cancel"}},isOpen:t,title:"Are you sure you want to reset changes?",tone:"negative"},null))}const T=e=>{const{spacing:t}=(0,d.Fg)();return(0,d.tZ)("div",(0,n.Z)({css:{marginTop:t.xlarge,marginBottom:t.xxlarge,position:"sticky",top:t.xlarge}},e))}},839:function(e,t,i){"use strict";i.d(t,{C:function(){return o}});var n=i(5631),l=i(5445),a=i(1511);const o=e=>(0,l.tZ)(n.zx,{css:{textDecoration:"none",":hover":{color:"white"}},as:a.rU,href:`/${e.list.path}/create`,tone:"active",size:"small",weight:"bold"},"Create ",e.list.singular)},8799:function(e,t,i){"use strict";i.d(t,{H:function(){return y},P:function(){return k}});var n=i(7896),l=i(5445),a=i(2784),o=i(5632),r=(i(5631),i(487),i(891),i(5273),i(9575)),s=i(1511),d=i(444),c=i(9097),u=i.n(c);const g=()=>{var e;const{spacing:t}=(0,l.Fg)(),{adminConfig:i}=(0,r.jf)();return null!==(e=i.components)&&void 0!==e&&e.Logo?(0,l.tZ)(i.components.Logo,null):(0,l.tZ)(l.H3,null,(0,l.tZ)(u(),{href:"/",passHref:!0},(0,l.tZ)("a",{css:{backgroundImage:"linear-gradient(to right, #0ea5e9, #6366f1)",backgroundClip:"text",lineHeight:"1.75rem",color:"transparent",verticalAlign:"middle",transition:"color 0.3s ease",textDecoration:"none"}},(0,l.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 220 220",css:{display:"inline-block",width:"2rem",height:"2rem",margin:`0  ${t.medium}px ${t.xsmall}px 0`,verticalAlign:"middle"}},(0,l.tZ)("defs",null,(0,l.tZ)("linearGradient",{id:"logo-a",x1:"0%",x2:"50%",y1:"0%",y2:"71.9%"},(0,l.tZ)("stop",{offset:"0%",stopColor:"#5AE8FA"}),(0,l.tZ)("stop",{offset:"100%",stopColor:"#2684FF"}))),(0,l.tZ)("path",{fill:"url(#logo-a)",fillRule:"evenodd",d:"M290.1 47h117.5c17.8 0 24.3 1.9 30.8 5.3a36.3 36.3 0 0115.1 15.2c3.5 6.5 5.4 13 5.4 30.8v117.4c0 17.9-1.9 24.3-5.4 30.8a36.3 36.3 0 01-15.1 15.2c-6.5 3.4-13 5.3-30.8 5.3H290c-17.8 0-24.3-1.9-30.8-5.3a36.3 36.3 0 01-15.1-15.2c-3.5-6.5-5.3-13-5.3-30.8V98.3c0-17.9 1.8-24.3 5.3-30.8a36.3 36.3 0 0115.1-15.2c6.5-3.4 13-5.3 30.8-5.3zm11.8 56.8V218H327v-36.8l14.4-14.6 34.4 51.4h31.5l-49-69.1 44.7-45.1h-31.3L327 151v-47.3H302z",transform:"translate(-238.9 -47)"})),"Keystone 6")))},m=e=>{let{href:t,children:i,isSelected:n}=e;const{colors:a,palette:r,spacing:d,radii:c,typography:u}=(0,l.Fg)(),g=(0,o.useRouter)(),m=void 0!==n?n:g.pathname===t;return(0,l.tZ)("li",null,(0,l.tZ)(s.rU,{"aria-current":!!m&&"location",href:t,css:{background:"transparent",borderBottomRightRadius:c.xsmall,borderTopRightRadius:c.xsmall,color:r.neutral700,display:"block",fontWeight:u.fontWeight.medium,marginBottom:d.xsmall,marginRight:d.xlarge,padding:`${d.small}px ${d.xlarge}px`,position:"relative",textDecoration:"none",":hover":{background:a.backgroundHover,color:a.linkHoverColor},"&[aria-current=location]":{background:r.neutral200,color:r.neutral900}}},i))},p=e=>{let{item:t}=e;const{apiPath:i}=(0,r.jf)(),{spacing:n,typography:a}=(0,l.Fg)();return(0,l.tZ)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",margin:n.xlarge,marginBottom:0}},!(!t||"authenticated"!==t.state)&&(0,l.tZ)("div",{css:{fontSize:a.fontSize.small}},"Signed in as ",(0,l.tZ)("strong",{css:{display:"block"}},t.label)),t&&"authenticated"===t.state&&(0,l.tZ)(d.S,null))},h=e=>{let{authenticatedItem:t,children:i}=e;const{spacing:n}=(0,l.Fg)();return(0,l.tZ)("div",{css:{display:"flex",flexDirection:"column",justifyContent:"center",position:"relative"}},(0,l.tZ)(p,{item:t}),(0,l.tZ)("nav",{role:"navigation","aria-label":"Side Navigation",css:{marginTop:n.xlarge}},(0,l.tZ)("ul",{css:{padding:0,margin:0,li:{listStyle:"none"}}},i)))},v=e=>{let{list:t}=e;const i=(0,o.useRouter)();return(0,l.tZ)(m,{isSelected:i.pathname.split("/")[1]===`/${t.path}`.split("/")[1],href:`/${t.path}${t.isSingleton?"/1":""}`},t.label)},f=e=>{let{lists:t=[],include:i=[]}=e;const n=i.length>0?t.filter((e=>i.includes(e.key))):t;return(0,l.tZ)(a.Fragment,null,n.map((e=>(0,l.tZ)(v,{key:e.key,list:e}))))},Z=()=>{var e;const{adminMeta:{lists:t},adminConfig:i,authenticatedItem:n,visibleLists:a}=(0,r.jf)();if("loading"===a.state)return null;if("error"===a.state)return(0,l.tZ)(l.xv,{as:"span",paddingLeft:"xlarge",css:{color:"red"}},a.error instanceof Error?a.error.message:a.error[0].message);const o=Object.keys(t).map((e=>a.lists.has(e)?t[e]:null)).filter((e=>Boolean(e)));return null!==i&&void 0!==i&&null!==(e=i.components)&&void 0!==e&&e.Navigation?(0,l.tZ)(i.components.Navigation,{authenticatedItem:n,lists:o}):(0,l.tZ)(h,{authenticatedItem:n},(0,l.tZ)(m,{href:"/"},"Dashboard"),(0,l.tZ)(f,{lists:o}))},y=80,x=e=>(0,l.tZ)(a.Fragment,null,(0,l.tZ)("style",null,"body { overflow: hidden; }"),(0,l.tZ)("div",(0,n.Z)({css:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) 4fr",gridTemplateRows:`${y}px auto`,height:"100vh",isolation:"isolate"}},e))),b=e=>(0,l.tZ)("aside",(0,n.Z)({css:{minWidth:0,overflowY:"auto",WebkitOverflowScrolling:"touch"}},e)),w=e=>{const{colors:t,spacing:i}=(0,l.Fg)();return(0,l.tZ)("main",(0,n.Z)({css:{backgroundColor:t.background,boxSizing:"border-box",minWidth:0,paddingLeft:i.xlarge,paddingRight:i.xlarge,overflowY:"auto",WebkitOverflowScrolling:"touch",position:"relative"}},e))},k=e=>{let{children:t,header:i,title:n}=e;const{colors:a,spacing:o}=(0,l.Fg)();return(0,l.tZ)(x,null,(0,l.tZ)("div",{css:{alignItems:"center",borderBottom:`1px solid ${a.border}`,display:"flex",justifyContent:"space-between",paddingLeft:o.xlarge,paddingRight:o.xlarge}},(0,l.tZ)(g,null)),(0,l.tZ)("header",{css:{alignItems:"center",backgroundColor:a.background,borderBottom:`1px solid ${a.border}`,display:"flex",justifyContent:"space-between",minWidth:0,paddingLeft:o.xlarge,paddingRight:o.xlarge}},(0,l.tZ)("title",null,n?`Keystone - ${n}`:"Keystone"),i),(0,l.tZ)(b,null,(0,l.tZ)(Z,null)),(0,l.tZ)(w,null,t))}},7162:function(e,t,i){"use strict";i.d(t,{B:function(){return m},C:function(){return g},I:function(){return u}});var n=i(7896),l=i(5445),a=i(5273),o=i(2784),r=i(9740),s=i(1511);const d=["children"],c=e=>{let{children:t}=e,i=(0,r.Z)(e,d);return(0,l.tZ)("div",(0,n.Z)({css:{minWidth:0,maxWidth:1080}},i),t)};function u(e){const{palette:t,spacing:i}=(0,l.Fg)();return(0,l.tZ)(c,{css:{alignItems:"center",display:"flex",flex:1,justifyContent:"space-between"}},(0,l.tZ)("div",{css:{alignItems:"center",display:"flex",flex:1,minWidth:0}},e.list.isSingleton?(0,l.tZ)(l.X6,{type:"h3"},e.list.label):(0,l.tZ)(o.Fragment,null,(0,l.tZ)(l.X6,{type:"h3"},(0,l.tZ)(s.rU,{href:`/${e.list.path}`,css:{textDecoration:"none"}},e.list.label)),(0,l.tZ)("div",{css:{color:t.neutral500,marginLeft:i.xsmall,marginRight:i.xsmall}},(0,l.tZ)(a.X,null)),(0,l.tZ)(l.X6,{as:"h1",type:"h3",css:{minWidth:0,maxWidth:"100%",overflow:"hidden",flex:1,textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.label))))}function g(e){const{spacing:t}=(0,l.Fg)();return(0,l.tZ)(c,{css:{position:"relative",height:"100%"}},(0,l.tZ)("div",(0,n.Z)({css:{alignItems:"start",display:"grid",gap:t.xlarge,gridTemplateColumns:"2fr 1fr"}},e)))}function m(e){const{colors:t,spacing:i}=(0,l.Fg)();return(0,l.tZ)("div",{css:{background:t.background,borderTop:`1px solid ${t.border}`,bottom:0,display:"flex",justifyContent:"space-between",marginTop:i.xlarge,paddingBottom:i.xlarge,paddingTop:i.xlarge,position:"sticky",zIndex:20}},e.children)}},3123:function(e,t,i){"use strict";i.d(t,{K:function(){return a}});var n=i(2784),l=i(7074);i(5445);const a=(0,l.c)(n.createElement(n.Fragment,null,n.createElement("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),n.createElement("rect",{x:8,y:2,width:8,height:4,rx:1,ry:1})),"ClipboardIcon")},4273:function(e){function t(){return new DOMException("The request is not allowed","NotAllowedError")}e.exports=async function(e){try{await async function(e){if(!navigator.clipboard)throw t();return navigator.clipboard.writeText(e)}(e)}catch(i){try{await async function(e){const i=document.createElement("span");i.textContent=e,i.style.whiteSpace="pre",i.style.webkitUserSelect="auto",i.style.userSelect="all",document.body.appendChild(i);const n=window.getSelection(),l=window.document.createRange();n.removeAllRanges(),l.selectNode(i),n.addRange(l);let a=!1;try{a=window.document.execCommand("copy")}finally{n.removeAllRanges(),window.document.body.removeChild(i)}if(!a)throw t()}(e)}catch(n){throw n||i||t()}}}}}]);